# PhyAug for Fisheye Image Recognition
This is PhyAug for fisheye image recognition case study in submitted TMC paper: [PhyAug: Physics-Directed Data Augmentation for Deep Sensing Model to Specific Sensor](https://arxiv.org/pdf/2104.01160.pdf).

## Implementation details
We apply PhyAug for fisheye image recognition. Applying DNN models that pre-trained on pinhole camera dataset (e.g., ImageNet) on fisheye image will observe accuracy drop. We propose to exploit first principle of fisheye camera model to transfer DNN model to target fisheye camera.

## Dataset
Dataset use in our experiment is generated by `fisheye_converion.py`. We use this script to convert Caltech-101 dataset to a specific fisheye dataset.
The dataset we used in our paper can be downloaded from this [link](https://researchdata.ntu.edu.sg/dataset.xhtml?persistentId=doi:10.21979/N9/R5LKHI). Please download it and place it under `/data` folder. The dataset should be organized in this hierarchy:

```
/data
    /train
        /class1
        /class2
            .
            .
    /test
        /class_1
        /class_2
        /class_3
    /eval
        /class_1
        /class_2
        /class_3
```

## Train/Eval model
We use pretrained ResNet50 model, freeze the feature encoder layer, change the output number to match the Caltech dataset classes. During the training, only weights in the fully connected layers are updated. To train model, simply execute the following command. It will generate similar results as we report in paper.

```bash
python Caltech-fisheye-train.py
```

## Hardware specification
The code is evaluted on a workstation with following specifications:
- CPU: Intel Core i9-7900X 3.30GHz 13.75MB Cache 10C/20T
- GPU: 4x Zotac nVidia RTX2080Ti 11GB GDDR6 PCIe x16 GPU Card